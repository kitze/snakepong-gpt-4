<!doctype html>
<html class="no-js" lang="">

<head>
  <meta charset="utf-8">
  <title>SnakePong</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="SnakePong">
  <meta property="og:type" content="">
  <meta property="og:url" content="">
  <meta property="og:image" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

  <link rel="manifest" href="site.webmanifest">
  <link rel="apple-touch-icon" href="icon.png">
  <!-- Place favicon.ico in the root directory -->

  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/main.css">

  <meta name="theme-color" content="#fafafa">

  <link href="https://fonts.googleapis.com/css?family=Press+Start+2P" rel="stylesheet">
  <script>
    // Feature detection for DeviceMotionEvent and DeviceOrientationEvent

    let gyroscopeEnabled = false;

    if (
      typeof DeviceMotionEvent.requestPermission === "function" ||
      typeof DeviceOrientationEvent.requestPermission === "function"
    ) {
      document.addEventListener("DOMContentLoaded", () => {
        const button = document.createElement("button");
        button.textContent = "Enable Gyroscope Controls";
        button.style.position = "fixed";
        button.style.bottom = "20px";
        button.style.left = "50%";
        button.style.transform = "translateX(-50%)";
        button.style.zIndex = "9999";
        button.onclick = requestGyroscopeAccess;
        document.body.appendChild(button);
      });

      function requestGyroscopeAccess() {
        if (gyroscopeEnabled) {
          // If gyroscope controls are enabled, remove the event listeners and update the button text
          window.removeEventListener("devicemotion", handleDeviceMotion);
          window.removeEventListener("deviceorientation", handleDeviceOrientation);
          gyroscopeEnabled = false;
          button.textContent = "Enable Gyroscope Controls";
        } else {
          // If gyroscope controls are disabled, request permission and add the event listeners
          if (typeof DeviceMotionEvent.requestPermission === "function") {
            DeviceMotionEvent.requestPermission()
              .then((permissionState) => {
                if (permissionState === "granted") {
                  window.addEventListener("devicemotion", handleDeviceMotion);
                }
              })
              .catch(console.error);
          }

          if (typeof DeviceOrientationEvent.requestPermission === "function") {
            DeviceOrientationEvent.requestPermission()
              .then((permissionState) => {
                if (permissionState === "granted") {
                  window.addEventListener("deviceorientation", handleDeviceOrientation);
                }
              })
              .catch(console.error);
          }

          // If the device does not require permission, add the event listeners directly
          if (
            typeof DeviceMotionEvent.requestPermission !== "function" &&
            typeof DeviceOrientationEvent.requestPermission !== "function"
          ) {
            window.addEventListener("devicemotion", handleDeviceMotion);
            window.addEventListener("deviceorientation", handleDeviceOrientation);
          }

          gyroscopeEnabled = true;
          button.textContent = "Disable Gyroscope Controls";
        }
      }    } else {
      // Add event listeners directly for devices that don't require permission
      window.addEventListener("devicemotion", handleDeviceMotion);
      window.addEventListener("deviceorientation", handleDeviceOrientation);
    }
  </script>
</head>

<body>

<div id="gameContainer">
  <div class="titles">
    <div class="title">SnakePong</div>
    <a href="https://twitter.com/thekitze" class="kitze">by @thekitze</a>
  </div>
  <canvas id="gameCanvas" width="640" height="480"></canvas>
  <div id="touchAreaUp" class="touchArea"></div>
  <div id="touchAreaDown" class="touchArea"></div>
  <div id="touchAreaLeft" class="touchArea"></div>
  <div id="touchAreaRight" class="touchArea"></div>
  <div id="gameOverBanner">
    <h1>Game Over</h1>
    <p>Your score: <span id="finalScore"></span></p>
    <div id="restartButton">Restart Game</div>
  </div>
  <div id="controls">
    <div>
      <label for="score">Score:</label>
      <span id="score">0</span>
    </div>
<!--    <label for="gameSpeed">Game Speed:</label>-->
<!--    <input type="range" id="gameSpeed" name="gameSpeed" min="1" max="10" value="5">-->
  </div>
</div>
  <script src="js/vendor/modernizr-3.11.2.min.js"></script>
  <script src="js/main.js"></script>


</body>

</html>
